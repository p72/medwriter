# MedWriter 要件定義

## 1. システム概要
診療記録を効率的に管理・編集するためのWebアプリケーション。シンプルで使いやすいインターフェースを提供し、診療記録の追加、表示、更新、削除、データのインポート/エクスポート機能を実装。OpenAI APIを活用した診療内容のアドバイス機能を提供。GPT-4oとGPT-3.5-turboの切り替えが可能。

## 2. 機能要件

### 2.1 基本機能
- 診療記録の追加
  - 患者ID、患者氏名、診療日、Problem list、診察治療の入力
  - 必須項目（患者ID、患者氏名、診療日、Problem list）のバリデーション
  - 必須項目の視覚的表示（赤いアスタリスクとボーダー）
- 診療記録の表示
  - 表形式での一覧表示
  - 詳細表示（モーダル）
- 診療記録の更新
  - リストからの選択による更新
  - 更新確認ダイアログ
  - 更新後のフォームクリア
- 診療記録の削除
  - 個別レコードの削除
  - 全データのクリア
- データのエクスポート
  - CSV形式での出力
  - ファイル名：medical_records.csv
- データのインポート
  - CSV形式での読み込み
  - データ形式の検証

### 2.2 データ構造
各診療記録は以下の情報を含む：
- レコードID（自動生成）
- 患者ID（必須）
- 患者氏名（必須）
- 診療日（必須）
- Problem list（必須）
- 診察治療（任意）
- OpenAI API Key（文字列、クライアント側で保持）
- AIモデル（文字列、デフォルト：GPT-4o）

### 2.3 画面構成
1. ヘッダー
   - システムタイトル（🏥 MedWriter）

2. メインコンテンツ
   - 診療記録入力フォーム
     - 患者ID（テキスト入力、必須）
     - 患者氏名（テキスト入力、必須）
     - 診療日（日付選択、必須）
     - Problem list（テキストエリア、必須）
     - 診察治療（テキストエリア、任意）
     - OpenAI API Key（テキスト入力、任意）
     - AIモデル（テキスト入力、デフォルト：GPT-4o）
   - 操作ボタン
     - 診療記録追加（プライマリ）
     - 更新（警告色、選択時のみ表示）
     - データエクスポート（セカンダリ）
     - データインポート（セカンダリ）
     - データクリア（デンジャー）
   - 診療履歴表示
     - 表形式での表示（ID、氏名、診療日、Problem list、診察治療、操作）
     - 選択ボタン
     - 削除ボタン

## 3. 非機能要件

### 3.1 ユーザビリティ
- シンプルで直感的なUI
  - モダンなデザイン
  - 適切な余白とコントラスト
  - 明確な視覚的階層
  - 必須項目の視覚的表示
- レスポンシブデザイン
  - デスクトップ対応
  - タブレット対応（768px以下で1カラム表示）
  - モバイル対応
- インタラクション
  - ホバーエフェクト
  - クリックフィードバック
  - モーダル表示
  - 更新確認ダイアログ

### 3.2 データ管理
- CSV形式でのデータ保存
  - UTF-8エンコーディング
  - カンマ区切り形式
- ブラウザメモリ内でのデータ保持
  - セッション中のみ保持
  - ページリロードで初期化
- ページ離脱時の確認
  - 未保存データがある場合の警告

### 3.3 入力バリデーション
- 必須項目チェック
  - 患者ID
  - 患者氏名
  - 診療日
  - Problem list
- エラーメッセージ
  - 日本語表示
  - 明確な指示
  - 必須項目の一覧表示

## 4. 技術要件

### 4.1 フロントエンド
- HTML5
  - セマンティックな構造
  - アクセシビリティ対応
  - 必須項目の属性指定
- CSS3
  - フレックスボックス
  - グリッドレイアウト
  - メディアクエリ
  - カスタムスタイル（必須項目表示）
- JavaScript
  - バニラJS
  - モダンな構文
  - モジュール化された関数
  - フォームバリデーション

### 4.2 データ形式
- CSV形式
  - ヘッダー行なし
  - カンマ区切り
  - 文字エスケープ対応

## 5. 制約事項
- ブラウザのメモリ内でのみデータを保持
- セッション終了時にデータは消去
- ローカルストレージは使用しない
- サーバーサイドの機能は実装しない

## 6. 今後の拡張性
- データの永続化機能
  - ローカルストレージ対応
  - サーバーサイド連携
- 検索・フィルタリング機能
  - 患者ID/氏名での検索
  - 日付範囲での絞り込み
- 印刷機能
  - レコードの印刷
  - PDF出力
- バックアップ機能
  - 自動バックアップ
  - 復元機能
- 多言語対応
  - 英語/日本語切り替え
  - 地域設定対応
- AIアドバイス機能
  - OpenAI APIを使用した診療内容の分析
  - 診断や治療方針の妥当性の確認
  - 追加で考慮すべき点の提案
  - 患者への説明やフォローアップの提案
  - 医療記録の記載方法の改善点の提示
  - アドバイス履歴の保存機能
  - 複数のAIモデル対応
    - GPT-4o（高精度）
    - GPT-3.5-turbo（高速）
    - その他のモデルの追加対応 